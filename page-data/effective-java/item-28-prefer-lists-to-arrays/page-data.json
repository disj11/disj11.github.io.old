{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/effective-java/item-28-prefer-lists-to-arrays/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Dev Logs","author":"tykim","siteUrl":"https://disj11.github.io","comment":{"disqusShortName":"","utterances":""},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"f27f4b3c-5027-562c-b241-b7551e73a5c1","excerpt":"배열과 제네릭의 차이 배열과 제네릭에는 중요한 두 가지 차이가 있다. 첫 번째 차이점은 배열은 공변(covariant)인 반면 제네릭은 불공변(invariant)라는 것이며, 두 번째 차이점은 배열은 실체화(reify…","html":"<h2 id=\"배열과-제네릭의-차이\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%EC%97%B4%EA%B3%BC-%EC%A0%9C%EB%84%A4%EB%A6%AD%EC%9D%98-%EC%B0%A8%EC%9D%B4\" aria-label=\"배열과 제네릭의 차이 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배열과 제네릭의 차이</h2>\n<p>배열과 제네릭에는 중요한 두 가지 차이가 있다. 첫 번째 차이점은 배열은 <strong>공변</strong>(covariant)인 반면 제네릭은 <strong>불공변</strong>(invariant)라는 것이며, 두 번째 차이점은 배열은 <strong>실체화</strong>(reify)되지만 리스트는 그렇지 않다는 것이다.</p>\n<h3 id=\"공변과-불공변\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EB%B3%80%EA%B3%BC-%EB%B6%88%EA%B3%B5%EB%B3%80\" aria-label=\"공변과 불공변 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공변과 불공변</h3>\n<p>공변은 <code class=\"language-text\">Sub</code>가 <code class=\"language-text\">Super</code>의 하위 타입이라면 배열 <code class=\"language-text\">Sub[]</code>는 배열 <code class=\"language-text\">Super[]</code>의 하위타입이 된다는 의미이다. 불공변이란 서로 다른 타입 <code class=\"language-text\">Type1</code>과 <code class=\"language-text\">Type2</code>가 있을 때, <code class=\"language-text\">List&lt;Type1></code>은 <code class=\"language-text\">List&lt;Type2></code>의 하위 타입도 아니고 상위 타입도 아니라는 의미이다. 다음의 예시를 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> objectArray <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">Long</code>는 <code class=\"language-text\">Object</code>의 하위타입이므로 배열에서는 위 문법이 허용된다. 하지만 다음과 같은 문법은 허용되지 않는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> ol <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Long</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>언뜻 보면 리스트에 문제가 있어 보이지만, 사실 문제는 배열에 있다. 다음의 예를 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> objectArray <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\nobjectArray<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"문자열을 넣는다.\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ArrayStoreException 발생</span></code></pre></div>\n<p>위 코드는 문법상 오류가 없기 때문에 컴파일이 정상적으로 되지만, 런타임 시 <code class=\"language-text\">ArrayStoreException</code>을 던진다. 반면에 리스트를 사용할 경우 앞에서 알아본 것 처럼 컴파일 시점에서 오류를 확인 할 수 있다.</p>\n<h3 id=\"실체화\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%B2%B4%ED%99%94\" aria-label=\"실체화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실체화</h3>\n<p>실체화란 런타임 시점에도 자신이 담기로한 원소의 타입을 확인한다는 것이다. 이러한 특성으로 앞에서 살펴본 것 처럼 <code class=\"language-text\">Long</code> 배열에 <code class=\"language-text\">String</code> 원소를 넣으려고 하면 런타임 시점에 <code class=\"language-text\">ArrayStoreException</code>이 발생한다. 반면 제네릭은 컴파일 시에만 타입 검사를 하고, 런타임 시에는 타입이 소거된다. 이렇게 런타임에 컴파일타임보다 타입 정보를 적게 가지는 타입을 <strong>실체화 불가 타입</strong>(non-reifiable type) 이라고 한다. 실체화 불가 타입에는 <code class=\"language-text\">E</code>, <code class=\"language-text\">List&lt;E></code>, <code class=\"language-text\">List&lt;String></code> 등이 있다.</p>\n<h2 id=\"예제\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%A0%9C\" aria-label=\"예제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예제</h2>\n<p>다음과 같이 배열을 사용한 <code class=\"language-text\">Chooser</code> 클래스가 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Chooser</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> choiceArray<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Chooser</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span> choices<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        choiceArray <span class=\"token operator\">=</span> choices<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">choose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Random</span> rnd <span class=\"token operator\">=</span> <span class=\"token class-name\">ThreadLocalRandom</span><span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> choiceArray<span class=\"token punctuation\">[</span>rnd<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span>choiceArray<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 클래스를 사용하려면 <code class=\"language-text\">choose</code> 메서드를 호출할 때마다 반환된 <code class=\"language-text\">Object</code>를 원하는 타입으로 형변환 해야하는 불편함이 있다. 혹시나 타입이 다른 원소가 들어있다면, 런타임 시 형변환 오류가 날 가능성도 있다. 이 클래스를 제네릭으로 변경해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Chooser</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> choiceArray<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Chooser</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> choices<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        choiceArray <span class=\"token operator\">=</span> choices<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">T</span> <span class=\"token function\">choose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Random</span> rnd <span class=\"token operator\">=</span> <span class=\"token class-name\">ThreadLocalRandom</span><span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> choiceArray<span class=\"token punctuation\">[</span>rnd<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span>choiceArray<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 클래스를 컴파일하면 <code class=\"language-text\">Object[]</code>를 <code class=\"language-text\">T[]</code>로 변환할 수 없다는 오류가 발생한다. 이는 Object 배열을 T 배열로 형변환하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">choiceArray <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> choices<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이렇게 변경하면 오류는 해결되지만, 경고가 발생한다. 이 형변환이 런타임에도 안전한지 보장할 수 없기 때문에 발생하는 경고이다. 코드를 작성자가 안전하다고 확신한다면 주석을 남기고 애너테이션을 달아 경고를 숨겨도 되지만, 경고의 원인을 제거하는 편이 훨씬 좋을 것이다. 다음처럼 코드를 변경해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Chooser</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> choiceList<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Chooser</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> choices<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        choicesList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>choices<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">T</span> <span class=\"token function\">choose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Random</span> rnd <span class=\"token operator\">=</span> <span class=\"token class-name\">ThreadLocalRandom</span><span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> choiceList<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>rnd<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span>choiceList<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 코드는 <code class=\"language-text\">Object[]</code>를 사용했을 때와는 다르게 <code class=\"language-text\">choose</code> 메서드 사용시 형변환 해야할 필요도 없으며, 이로 인해 런타임 시 발생할 수 있는 <code class=\"language-text\">ClassCastException</code>를 걱정할 필요가 없다.</p>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>배열은 공변이고 실체화되는 반면에 제네릭은 불공변이고 타입 정보가 런타임시 소거된다. 이렇게 완전히 다른 규칙이 적용되므로 제네릭과 배열을 섞어 쓰기란 쉽지 않다. 만약 둘을 섞어 쓰다 컴파일 오류나 경고를 만난다면, 가장 먼저 배열을 리스트로 대체하는 방법을 적용해보자.</p>","frontmatter":{"title":"ITEM 28. 배열보다는 리스트를 사용하라","date":"October 20, 2021"}}},"pageContext":{"slug":"/effective-java/item-28-prefer-lists-to-arrays/","previous":{"fields":{"slug":"/effective-java/item-17-minimize-mutability/"},"frontmatter":{"title":"ITEM 17. 변경 가능성을 최소화하라"}},"next":{"fields":{"slug":"/effective-java/item-31-use-bounded-wildcards/"},"frontmatter":{"title":"ITEM 31. 한정적 와일드카드를 사용해 API 유연성을 높여라"}}}},
    "staticQueryHashes": ["3078735561","3128451518"]}